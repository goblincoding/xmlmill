\hypertarget{gctreewidgetitem_8cpp_source}{\section{gctreewidgetitem.\-cpp}
}

\begin{DoxyCode}
00001 \textcolor{comment}{/* Copyright (c) 2012 - 2013 by William Hallatt.}
00002 \textcolor{comment}{ *}
00003 \textcolor{comment}{ * This file forms part of "XML Mill".}
00004 \textcolor{comment}{ *}
00005 \textcolor{comment}{ * The official website for this project is <http://www.goblincoding.com> and,}
00006 \textcolor{comment}{ * although not compulsory, it would be appreciated if all works of whatever}
00007 \textcolor{comment}{ * nature using this source code (in whole or in part) include a reference to}
00008 \textcolor{comment}{ * this site.}
00009 \textcolor{comment}{ *}
00010 \textcolor{comment}{ * Should you wish to contact me for whatever reason, please do so via:}
00011 \textcolor{comment}{ *}
00012 \textcolor{comment}{ *                 <http://www.goblincoding.com/contact>}
00013 \textcolor{comment}{ *}
00014 \textcolor{comment}{ * This program is free software: you can redistribute it and/or modify it
       under}
00015 \textcolor{comment}{ * the terms of the GNU General Public License as published by the Free
       Software}
00016 \textcolor{comment}{ * Foundation, either version 3 of the License, or (at your option) any later}
00017 \textcolor{comment}{ * version.}
00018 \textcolor{comment}{ *}
00019 \textcolor{comment}{ * This program is distributed in the hope that it will be useful, but WITHOUT}
00020 \textcolor{comment}{ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
       FITNESS}
00021 \textcolor{comment}{ * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
       details.}
00022 \textcolor{comment}{ *}
00023 \textcolor{comment}{ * You should have received a copy of the GNU General Public License along with}
00024 \textcolor{comment}{ * this program (GNUGPL.txt).  If not, see}
00025 \textcolor{comment}{ *}
00026 \textcolor{comment}{ *                    <http://www.gnu.org/licenses/>}
00027 \textcolor{comment}{ */}
00028 \textcolor{preprocessor}{#include "gctreewidgetitem.h"}
00029 \textcolor{preprocessor}{#include "gcglobalspace.h"}
00030 
00031 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00032 
\hypertarget{gctreewidgetitem_8cpp_source_l00033}{}\hyperlink{class_g_c_tree_widget_item_ab8ffe3b11f00edd90397b885bb58d4a4}{00033} \hyperlink{class_g_c_tree_widget_item_ab8ffe3b11f00edd90397b885bb58d4a4}{GCTreeWidgetItem::GCTreeWidgetItem}( QDomElement element )
00034 \{
00035   init( element, -1 );
00036 \}
00037 
00038 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00039 
\hypertarget{gctreewidgetitem_8cpp_source_l00040}{}\hyperlink{class_g_c_tree_widget_item_a82819ce07ee6d70fe41518c8a0382fcf}{00040} \hyperlink{class_g_c_tree_widget_item_ab8ffe3b11f00edd90397b885bb58d4a4}{GCTreeWidgetItem::GCTreeWidgetItem}( QDomElement element, \textcolor{keywordtype}{int} index )
00041 \{
00042   init( element, index );
00043 \}
00044 
00045 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00046 
00047 \textcolor{keywordtype}{void} GCTreeWidgetItem::init( QDomElement element, \textcolor{keywordtype}{int} index )
00048 \{
00049   m\_element = \hyperlink{class_g_c_tree_widget_item_a584cad866bdbd94710d31eb77b804d84}{element};
00050   m\_elementExcluded = \textcolor{keyword}{false};
00051   m\_index = \hyperlink{class_g_c_tree_widget_item_af6b48ae274cc4989811ef44944c8ad76}{index};
00052   m\_verbose = \hyperlink{namespace_g_c_global_space_ad9a35f311bda4dd28f5cf155c5efc818}{GCGlobalSpace::showTreeItemsVerbose}();
00053 
00054   QDomNamedNodeMap attributes = m\_element.attributes();
00055 
00056   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i = 0; i < attributes.size(); ++i )
00057   \{
00058     m\_includedAttributes.append( attributes.item( i ).toAttr().name() );
00059   \}
00060 
00061   setDisplayText();
00062 \}
00063 
00064 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00065 
00066 \textcolor{keywordtype}{void} GCTreeWidgetItem::setDisplayText()
00067 \{
00068   \textcolor{keywordflow}{if}( m\_verbose )
00069   \{
00070     setText( 0, \hyperlink{class_g_c_tree_widget_item_acbd4573d56cc5c6d9bd58c461b797115}{toString}() );
00071     setToolTip( 0, \textcolor{stringliteral}{""} );
00072   \}
00073   \textcolor{keywordflow}{else}
00074   \{
00075     setText( 0, m\_element.tagName() );
00076     setToolTip( 0, \hyperlink{class_g_c_tree_widget_item_acbd4573d56cc5c6d9bd58c461b797115}{toString}() );
00077   \}
00078 \}
00079 
00080 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00081 
\hypertarget{gctreewidgetitem_8cpp_source_l00082}{}\hyperlink{class_g_c_tree_widget_item_a1125dbc55a8ba3e50662b8258cb35fdf}{00082} \hyperlink{class_g_c_tree_widget_item}{GCTreeWidgetItem} *\hyperlink{class_g_c_tree_widget_item_a1125dbc55a8ba3e50662b8258cb35fdf}{GCTreeWidgetItem::gcParent}()\textcolor{keyword}{ const}
00083 \textcolor{keyword}{}\{
00084   \textcolor{keywordflow}{return} \textcolor{keyword}{dynamic\_cast<} \hyperlink{class_g_c_tree_widget_item}{GCTreeWidgetItem}* \textcolor{keyword}{>}( parent() );
00085 \}
00086 
00087 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00088 
\hypertarget{gctreewidgetitem_8cpp_source_l00089}{}\hyperlink{class_g_c_tree_widget_item_af44c0d2c5eaa1c5bb3a6a1aace3e8c78}{00089} \hyperlink{class_g_c_tree_widget_item}{GCTreeWidgetItem} *\hyperlink{class_g_c_tree_widget_item_af44c0d2c5eaa1c5bb3a6a1aace3e8c78}{GCTreeWidgetItem::gcChild}( \textcolor{keywordtype}{int} index )\textcolor{keyword}{ const}
00090 \textcolor{keyword}{}\{
00091   \textcolor{keywordflow}{return} \textcolor{keyword}{dynamic\_cast<} \hyperlink{class_g_c_tree_widget_item}{GCTreeWidgetItem}* \textcolor{keyword}{>}( child( index ) );
00092 \}
00093 
00094 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00095 
\hypertarget{gctreewidgetitem_8cpp_source_l00096}{}\hyperlink{class_g_c_tree_widget_item_a584cad866bdbd94710d31eb77b804d84}{00096} QDomElement \hyperlink{class_g_c_tree_widget_item_a584cad866bdbd94710d31eb77b804d84}{GCTreeWidgetItem::element}()\textcolor{keyword}{ const}
00097 \textcolor{keyword}{}\{
00098   \textcolor{keywordflow}{return} m\_element;
00099 \}
00100 
00101 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00102 
\hypertarget{gctreewidgetitem_8cpp_source_l00103}{}\hyperlink{class_g_c_tree_widget_item_a4c1932884c3e7c0da8be9e2582e02f41}{00103} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_a4c1932884c3e7c0da8be9e2582e02f41}{GCTreeWidgetItem::setExcludeElement}( \textcolor{keywordtype}{bool} exclude )
00104 \{
00105   \textcolor{keywordflow}{if}( \hyperlink{class_g_c_tree_widget_item_a1125dbc55a8ba3e50662b8258cb35fdf}{gcParent}() )
00106   \{
00107     \textcolor{keywordflow}{if}( exclude )
00108     \{
00109       \hyperlink{class_g_c_tree_widget_item_a1125dbc55a8ba3e50662b8258cb35fdf}{gcParent}()->\hyperlink{class_g_c_tree_widget_item_a584cad866bdbd94710d31eb77b804d84}{element}().removeChild( m\_element );
00110     \}
00111     \textcolor{keywordflow}{else}
00112     \{
00113       \hyperlink{class_g_c_tree_widget_item_a1125dbc55a8ba3e50662b8258cb35fdf}{gcParent}()->\hyperlink{class_g_c_tree_widget_item_a584cad866bdbd94710d31eb77b804d84}{element}().appendChild( m\_element );
00114     \}
00115   \}
00116 
00117   m\_elementExcluded = exclude;
00118 \}
00119 
00120 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00121 
\hypertarget{gctreewidgetitem_8cpp_source_l00122}{}\hyperlink{class_g_c_tree_widget_item_a9ea36ae7110324b227abea2036063b96}{00122} \textcolor{keywordtype}{bool} \hyperlink{class_g_c_tree_widget_item_a9ea36ae7110324b227abea2036063b96}{GCTreeWidgetItem::elementExcluded}()\textcolor{keyword}{ const}
00123 \textcolor{keyword}{}\{
00124   \textcolor{keywordflow}{return} m\_elementExcluded;
00125 \}
00126 
00127 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00128 
\hypertarget{gctreewidgetitem_8cpp_source_l00129}{}\hyperlink{class_g_c_tree_widget_item_a76e60292eec635fd2e6df27a3e162e16}{00129} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_a76e60292eec635fd2e6df27a3e162e16}{GCTreeWidgetItem::excludeAttribute}( \textcolor{keyword}{const} QString &attribute )
00130 \{
00131   m\_element.removeAttribute( attribute );
00132   m\_includedAttributes.removeAll( attribute );
00133   m\_includedAttributes.sort();
00134   setDisplayText();
00135 \}
00136 
00137 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00138 
\hypertarget{gctreewidgetitem_8cpp_source_l00139}{}\hyperlink{class_g_c_tree_widget_item_a3f1c09758031e2a8fc1ac9336697b3d9}{00139} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_a3f1c09758031e2a8fc1ac9336697b3d9}{GCTreeWidgetItem::includeAttribute}( \textcolor{keyword}{const} QString &attribute, \textcolor{keyword}{const} 
      QString &value )
00140 \{
00141   m\_element.setAttribute( attribute, value );
00142   m\_includedAttributes.append( attribute );
00143   m\_includedAttributes.removeDuplicates();
00144   m\_includedAttributes.sort();
00145   setDisplayText();
00146 \}
00147 
00148 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00149 
\hypertarget{gctreewidgetitem_8cpp_source_l00150}{}\hyperlink{class_g_c_tree_widget_item_a91d71330acb400242d45b6d74c7e0f87}{00150} \textcolor{keywordtype}{bool} \hyperlink{class_g_c_tree_widget_item_a91d71330acb400242d45b6d74c7e0f87}{GCTreeWidgetItem::attributeIncluded}( \textcolor{keyword}{const} QString &attribute )\textcolor{keyword}{ const}
00151 \textcolor{keyword}{}\{
00152   \textcolor{keywordflow}{return} m\_includedAttributes.contains( attribute );
00153 \}
00154 
00155 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00156 
\hypertarget{gctreewidgetitem_8cpp_source_l00157}{}\hyperlink{class_g_c_tree_widget_item_abf57de97998e38563dc9020cdf4d8340}{00157} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_abf57de97998e38563dc9020cdf4d8340}{GCTreeWidgetItem::setIncrementAttribute}( \textcolor{keyword}{const} QString &attribute, \textcolor{keywordtype}{bool} 
      increment )
00158 \{
00159   \textcolor{keywordflow}{if}( increment )
00160   \{
00161     m\_incrementedAttributes.append( attribute );
00162   \}
00163   \textcolor{keywordflow}{else}
00164   \{
00165     m\_incrementedAttributes.removeAll( attribute );
00166   \}
00167 
00168   m\_incrementedAttributes.sort();
00169 \}
00170 
00171 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00172 
\hypertarget{gctreewidgetitem_8cpp_source_l00173}{}\hyperlink{class_g_c_tree_widget_item_af0b5f0f5449f402c90e5ab7ff74acc77}{00173} \textcolor{keywordtype}{bool} \hyperlink{class_g_c_tree_widget_item_af0b5f0f5449f402c90e5ab7ff74acc77}{GCTreeWidgetItem::incrementAttribute}( \textcolor{keyword}{const} QString &attribute )\textcolor{keyword}{ const}
00174 \textcolor{keyword}{}\{
00175   \textcolor{keywordflow}{return} m\_incrementedAttributes.contains( attribute );
00176 \}
00177 
00178 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00179 
\hypertarget{gctreewidgetitem_8cpp_source_l00180}{}\hyperlink{class_g_c_tree_widget_item_ada99ae07bebffd9714be294cdd3d920b}{00180} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_ada99ae07bebffd9714be294cdd3d920b}{GCTreeWidgetItem::fixAttributeValues}()
00181 \{
00182   m\_fixedValues.clear();
00183 
00184   QDomNamedNodeMap attributes = m\_element.attributes();
00185 
00186   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i = 0; i < attributes.size(); ++i )
00187   \{
00188     QDomAttr attribute = attributes.item( i ).toAttr();
00189     m\_fixedValues.insert( attribute.name(), attribute.value() );
00190   \}
00191 \}
00192 
00193 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00194 
\hypertarget{gctreewidgetitem_8cpp_source_l00195}{}\hyperlink{class_g_c_tree_widget_item_a62a31fad1e50915f6df144e23394abef}{00195} QString \hyperlink{class_g_c_tree_widget_item_a62a31fad1e50915f6df144e23394abef}{GCTreeWidgetItem::fixedValue}( \textcolor{keyword}{const} QString &attribute )\textcolor{keyword}{ const}
00196 \textcolor{keyword}{}\{
00197   \textcolor{keywordflow}{return} m\_fixedValues.value( attribute, QString() );
00198 \}
00199 
00200 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00201 
\hypertarget{gctreewidgetitem_8cpp_source_l00202}{}\hyperlink{class_g_c_tree_widget_item_ab9be6bb99410543a6238c9ad48f2a9f7}{00202} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_ab9be6bb99410543a6238c9ad48f2a9f7}{GCTreeWidgetItem::revertToFixedValues}()
00203 \{
00204   \textcolor{keywordflow}{foreach}( QString attribute, m\_fixedValues.keys() )
00205   \{
00206     m\_element.setAttribute( attribute, m\_fixedValues.value( attribute ) );
00207   \}
00208 \}
00209 
00210 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00211 
\hypertarget{gctreewidgetitem_8cpp_source_l00212}{}\hyperlink{class_g_c_tree_widget_item_acbd4573d56cc5c6d9bd58c461b797115}{00212} QString \hyperlink{class_g_c_tree_widget_item_acbd4573d56cc5c6d9bd58c461b797115}{GCTreeWidgetItem::toString}()\textcolor{keyword}{ const}
00213 \textcolor{keyword}{}\{
00214   QString text( \textcolor{stringliteral}{"<"} );
00215   text += m\_element.tagName();
00216 
00217   QDomNamedNodeMap attributes = m\_element.attributes();
00218 
00219   \textcolor{comment}{/* For elements with no attributes (e.g. <element/>). */}
00220   \textcolor{keywordflow}{if}( attributes.isEmpty() &&
00221       m\_element.childNodes().isEmpty() )
00222   \{
00223     text += \textcolor{stringliteral}{"/>"};
00224     \textcolor{keywordflow}{return} text;
00225   \}
00226 
00227   \textcolor{keywordflow}{if}( !attributes.isEmpty() )
00228   \{
00229     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i = 0; i < attributes.size(); ++i )
00230     \{
00231       text += \textcolor{stringliteral}{" "};
00232 
00233       QString attribute = attributes.item( i ).toAttr().name();
00234       text += attribute;
00235       text += \textcolor{stringliteral}{"=\(\backslash\)""};
00236 
00237       QString attributeValue = attributes.item( i ).toAttr().value();
00238       text += attributeValue;
00239       text += \textcolor{stringliteral}{"\(\backslash\)""};
00240     \}
00241 
00242     \textcolor{comment}{/* For elements without children but with attributes. */}
00243     \textcolor{keywordflow}{if}( m\_element.firstChild().isNull() )
00244     \{
00245       text += \textcolor{stringliteral}{"/>"};
00246     \}
00247     \textcolor{keywordflow}{else}
00248     \{
00249       \textcolor{comment}{/* For elements with children and attributes. */}
00250       text += \textcolor{stringliteral}{">"};
00251     \}
00252   \}
00253   \textcolor{keywordflow}{else}
00254   \{
00255     text += \textcolor{stringliteral}{">"};
00256   \}
00257 
00258   \textcolor{keywordflow}{return} text;
00259 \}
00260 
00261 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00262 
\hypertarget{gctreewidgetitem_8cpp_source_l00263}{}\hyperlink{class_g_c_tree_widget_item_af1f6be4d3badc00db1f92de2e7deb71f}{00263} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_af1f6be4d3badc00db1f92de2e7deb71f}{GCTreeWidgetItem::setIndex}( \textcolor{keywordtype}{int} index )
00264 \{
00265   m\_index = \hyperlink{class_g_c_tree_widget_item_af6b48ae274cc4989811ef44944c8ad76}{index};
00266 \}
00267 
00268 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00269 
\hypertarget{gctreewidgetitem_8cpp_source_l00270}{}\hyperlink{class_g_c_tree_widget_item_af6b48ae274cc4989811ef44944c8ad76}{00270} \textcolor{keywordtype}{int} \hyperlink{class_g_c_tree_widget_item_af6b48ae274cc4989811ef44944c8ad76}{GCTreeWidgetItem::index}()\textcolor{keyword}{ const}
00271 \textcolor{keyword}{}\{
00272   \textcolor{keywordflow}{return} m\_index;
00273 \}
00274 
00275 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00276 
\hypertarget{gctreewidgetitem_8cpp_source_l00277}{}\hyperlink{class_g_c_tree_widget_item_a831acd54bf1060e3ec45a8e46439385a}{00277} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_a831acd54bf1060e3ec45a8e46439385a}{GCTreeWidgetItem::rename}( \textcolor{keyword}{const} QString &newName )
00278 \{
00279   m\_element.setTagName( newName );
00280   setDisplayText();
00281 \}
00282 
00283 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00284 
\hypertarget{gctreewidgetitem_8cpp_source_l00285}{}\hyperlink{class_g_c_tree_widget_item_a3af8c66a690cd55986a38b996a375ba4}{00285} QString \hyperlink{class_g_c_tree_widget_item_a3af8c66a690cd55986a38b996a375ba4}{GCTreeWidgetItem::name}()\textcolor{keyword}{ const}
00286 \textcolor{keyword}{}\{
00287   \textcolor{keywordflow}{if}( !m\_element.isNull() )
00288   \{
00289     \textcolor{keywordflow}{return} m\_element.tagName();
00290   \}
00291 
00292   \textcolor{keywordflow}{return} QString( \textcolor{stringliteral}{""} );
00293 \}
00294 
00295 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00296 
\hypertarget{gctreewidgetitem_8cpp_source_l00297}{}\hyperlink{class_g_c_tree_widget_item_a557b0034fd98a444a7173d76a6320f4c}{00297} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_a557b0034fd98a444a7173d76a6320f4c}{GCTreeWidgetItem::setVerbose}( \textcolor{keywordtype}{bool} verbose )
00298 \{
00299   m\_verbose = verbose;
00300   setDisplayText();
00301 \}
00302 
00303 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
00304 
\hypertarget{gctreewidgetitem_8cpp_source_l00305}{}\hyperlink{class_g_c_tree_widget_item_a197806cd712ae04b129acd1699674df5}{00305} \textcolor{keywordtype}{void} \hyperlink{class_g_c_tree_widget_item_a197806cd712ae04b129acd1699674df5}{GCTreeWidgetItem::insertGcChild}( \textcolor{keywordtype}{int} index, \hyperlink{class_g_c_tree_widget_item}{GCTreeWidgetItem} *item )
00306 \{
00307   QTreeWidgetItem::insertChild( index + 1, item );
00308 
00309   QDomElement siblingElement = m\_element.firstChildElement();
00310   \textcolor{keywordtype}{int} counter = 0;
00311 
00312   \textcolor{keywordflow}{while}( !siblingElement.isNull() )
00313   \{
00314     \textcolor{keywordflow}{if}( counter == index )
00315     \{
00316       \textcolor{keywordflow}{break};
00317     \}
00318 
00319     counter++;
00320     siblingElement = siblingElement.nextSiblingElement();
00321   \}
00322 
00323   m\_element.insertAfter( item->\hyperlink{class_g_c_tree_widget_item_a584cad866bdbd94710d31eb77b804d84}{element}(), siblingElement );
00324 \}
00325 
00326 \textcolor{comment}{/*
      --------------------------------------------------------------------------------------*/}
\end{DoxyCode}
